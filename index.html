<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telegram File Sync</title>
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      height: 100vh;
      margin: 0;
      padding-top: 40px;
    }
    .drop-zone {
      border: 2px dashed #4caf50;
      padding: 30px;
      text-align: center;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
      background: #1e1e1e;
      cursor: pointer;
    }
    .custom-upload-btn {
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 8px;
      cursor: pointer;
    }
    .progress {
      width: 100%;
      max-width: 500px;
      height: 8px;
      background: #333;
      border-radius: 4px;
      margin-top: 20px;
      overflow: hidden;
    }
    .bar {
      width: 0%;
      height: 100%;
      background: #4caf50;
    }
  </style>
</head>
<body>
  <h2>üìÅ Telegram File Sharing System</h2>
  <div class="drop-zone" id="dropZone">
    <p>Drop files here or click to upload</p>
    <button class="custom-upload-btn" onclick="document.getElementById('fileInput').click()">Upload File</button>
    <input type="file" id="fileInput" hidden>
  </div>

  <div class="progress">
    <div class="bar" id="progressBar"></div>
  </div>

  <script>
    const botToken = '7743009303:AAEfCdb2kU3xjZHbU-mo_qUbP3wA4aejDRo';
    const chatId = '878604830'; // your bot's target channel or user ID
    const fileInput = document.getElementById('fileInput');
    const progressBar = document.getElementById('progressBar');
    let lastUpdateId = 0;

    // Drag and Drop
    const dropZone = document.getElementById('dropZone');
    dropZone.addEventListener('dragover', e => {
      e.preventDefault();
      dropZone.style.borderColor = '#ff9800';
    });
    dropZone.addEventListener('dragleave', () => {
      dropZone.style.borderColor = '#4caf50';
    });
    dropZone.addEventListener('drop', e => {
      e.preventDefault();
      dropZone.style.borderColor = '#4caf50';
      const files = e.dataTransfer.files;
      if (files.length > 0) uploadFile(files[0]);
    });

    fileInput.addEventListener('change', () => {
      const file = fileInput.files[0];
      if (file) uploadFile(file);
    });

    function uploadFile(file) {
      const formData = new FormData();
      formData.append('chat_id', chatId);
      formData.append('document', file); // Can be photo, video, etc.
      const xhr = new XMLHttpRequest();
      xhr.open('POST', `https://api.telegram.org/bot${botToken}/sendDocument`);
      xhr.upload.onprogress = (e) => {
        const percent = (e.loaded / e.total) * 100;
        progressBar.style.width = percent + '%';
      };
      xhr.onload = () => {
        progressBar.style.width = '0%';
        alert('‚úÖ File Sent to Telegram!');
      };
      xhr.send(formData);
    }

    // Polling Telegram for new files
    async function pollTelegram() {
      try {
        const res = await fetch(`https://api.telegram.org/bot${botToken}/getUpdates?offset=${lastUpdateId + 1}`);
        const data = await res.json();
        data.result.forEach(msg => {
          lastUpdateId = msg.update_id;
          if (msg.message?.document) {
            const fileId = msg.message.document.file_id;
            autoDownload(fileId, msg.message.document.file_name);
          }
        });
      } catch (err) {
        console.log('Error polling Telegram:', err);
      }
    }

    async function autoDownload(fileId, fileName = 'file') {
      try {
        const res1 = await fetch(`https://api.telegram.org/bot${botToken}/getFile?file_id=${fileId}`);
        const data1 = await res1.json();
        const filePath = data1.result.file_path;
        const fileUrl = `https://api.telegram.org/file/bot${botToken}/${filePath}`;

        const link = document.createElement('a');
        link.href = fileUrl;
        link.download = fileName;
        document.body.appendChild(link);
        link.click();
        link.remove();
      } catch (err) {
        console.log('Download error:', err);
      }
    }

    // Start polling every 3 seconds
    setInterval(pollTelegram, 3000);
  </script>
</body>
</html>
