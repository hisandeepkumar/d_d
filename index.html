<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telegram File Sync</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    :root {
      --primary-color: #007bff;
      --secondary-color: #6c757d;
      --background-color: #f8f9fa;
      --text-color: #212529;
      --file-item-bg: #ffffff;
      --progress-bg: #e9ecef;
      --progress-bar: #28a745;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--background-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      height: 100vh;
      margin: 0;
      padding-top: 40px;
    }
    .container {
      width: 90%;
      max-width: 600px;
      background: var(--file-item-bg);
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    .drop-zone {
      border: 2px dashed var(--primary-color);
      padding: 30px;
      text-align: center;
      border-radius: 10px;
      background: #fff;
      cursor: pointer;
      transition: border-color 0.3s;
    }
    .drop-zone:hover {
      border-color: var(--secondary-color);
    }
    .custom-upload-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .custom-upload-btn:hover {
      background: var(--secondary-color);
    }
    .progress-container {
      width: 100%;
      margin-top: 20px;
    }
    .progress {
      width: 100%;
      height: 8px;
      background: var(--progress-bg);
      border-radius: 4px;
      overflow: hidden;
    }
    .bar {
      width: 0%;
      height: 100%;
      background: var(--progress-bar);
      transition: width 0.3s;
    }
    .file-list {
      width: 100%;
      margin-top: 20px;
    }
    .file-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: var(--file-item-bg);
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .file-name {
      flex: 1;
      margin-right: 10px;
      font-weight: 500;
    }
    .download-icon {
      color: var(--primary-color);
      cursor: pointer;
      transition: color 0.3s;
    }
    .download-icon:hover {
      color: var(--secondary-color);
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin-bottom: 20px;
    }
    .header h2 {
      margin: 0;
      font-size: 1.5rem;
      color: var(--primary-color);
    }
    .header .fa-sync {
      color: var(--secondary-color);
      cursor: pointer;
      transition: color 0.3s;
    }
    .header .fa-sync:hover {
      color: var(--primary-color);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2><i class="fas fa-file-upload"></i> Telegram File Sync</h2>
      <i class="fas fa-sync" onclick="pollTelegram()"></i>
    </div>
    <div class="drop-zone" id="dropZone">
      <p><i class="fas fa-cloud-upload-alt"></i> Drop files here or click to upload</p>
      <button class="custom-upload-btn" onclick="document.getElementById('fileInput').click()">Upload Files</button>
      <input type="file" id="fileInput" multiple hidden>
    </div>
    <div class="progress-container" id="progressContainer"></div>
  </div>
  <div class="container file-list" id="fileList">
    <h3><i class="fas fa-folder-open"></i> Available Files</h3>
  </div>

  <script>
    const botToken = '7743009303:AAEfCdb2kU3xjZHbU-mo_qUbP3wA4aejDRo'; // यहाँ अपना बॉट टोकन डालें
    const chatId = '878604830'; // यहाँ अपना चैट ID डालें
    const fileInput = document.getElementById('fileInput');
    const progressContainer = document.getElementById('progressContainer');
    const fileList = document.getElementById('fileList');
    let lastUpdateId = 0;

    // ड्रैग एंड ड्रॉप
    const dropZone = document.getElementById('dropZone');
    dropZone.addEventListener('dragover', e => {
      e.preventDefault();
      dropZone.style.borderColor = var(--secondary-color);
    });
    dropZone.addEventListener('dragleave', () => {
      dropZone.style.borderColor = var(--primary-color);
    });
    dropZone.addEventListener('drop', e => {
      e.preventDefault();
      dropZone.style.borderColor = var(--primary-color);
      const files = e.dataTransfer.files;
      if (files.length > 0) uploadFiles(files);
    });

    fileInput.addEventListener('change', () => {
      const files = fileInput.files;
      if (files.length > 0) uploadFiles(files);
    });

    // फाइल्स अपलोड करना
    function uploadFiles(files) {
      Array.from(files).forEach(file => {
        const progressId = `progress-${Math.random().toString(36).substr(2, 9)}`;
        const progressHTML = `
          <div id="${progressId}" class="progress">
            <div class="bar" style="width: 0%"></div>
          </div>
        `;
        progressContainer.innerHTML += progressHTML;
        uploadFile(file, progressId);
      });
    }

    function uploadFile(file, progressId) {
      const formData = new FormData();
      formData.append('chat_id', chatId);
      formData.append('document', file);
      const xhr = new XMLHttpRequest();
      xhr.open('POST', `https://api.telegram.org/bot${botToken}/sendDocument`);
      xhr.upload.onprogress = (e) => {
        const percent = (e.loaded / e.total) * 100;
        document.querySelector(`#${progressId} .bar`).style.width = percent + '%';
      };
      xhr.onload = () => {
        document.querySelector(`#${progressId}`).remove();
        alert(`✅ File Uploaded: ${file.name}`);
      };
      xhr.send(formData);
    }

    // टेलीग्राम से फाइल्स चेक करना और ऑटो-डाउनलोड
    async function pollTelegram() {
      try {
        const res = await fetch(`https://api.telegram.org/bot${botToken}/getUpdates?offset=${lastUpdateId + 1}`);
        const data = await res.json();
        data.result.forEach(msg => {
          lastUpdateId = msg.update_id;
          if (msg.message?.document) {
            const fileId = msg.message.document.file_id;
            const fileName = msg.message.document.file_name || 'Unnamed File';
            autoDownload(fileId, fileName);
          }
        });
      } catch (err) {
        console.log('Error polling Telegram:', err);
      }
    }

    // ऑटो-डाउनलोड फंक्शन
    async function autoDownload(fileId, fileName) {
      try {
        const res1 = await fetch(`https://api.telegram.org/bot${botToken}/getFile?file_id=${fileId}`);
        const data1 = await res1.json();
        const filePath = data1.result.file_path;
        const fileUrl = `https://api.telegram.org/file/bot${botToken}/${filePath}`;

        const response = await fetch(fileUrl);
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);

        const link = document.createElement('a');
        link.href = url;
        link.download = fileName;
        document.body.appendChild(link);
        link.click();
        link.remove();
        URL.revokeObjectURL(url);

        addFileToList(fileName);
      } catch (err) {
        console.log('Download error:', err);
      }
    }

    // फाइल लिस्ट में दिखाना
    function addFileToList(fileName) {
      const fileItem = document.createElement('div');
      fileItem.classList.add('file-item');
      fileItem.innerHTML = `
        <span class="file-name">${fileName}</span>
        <i class="fas fa-download download-icon" onclick="alert('File already downloaded: ${fileName}')"></i>
      `;
      fileList.appendChild(fileItem);
    }

    // हर 3 सेकंड में चेक करना
    setInterval(pollTelegram, 3000);
  </script>
</body>
</html>
